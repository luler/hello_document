(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[929],{61806:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return BaseComponent}});var C_work_hello_document_code_web_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_classCallCheck_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(69610),C_work_hello_document_code_web_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_createClass_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(54941),C_work_hello_document_code_web_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_get_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(63543),C_work_hello_document_code_web_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_getPrototypeOf_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(94663),C_work_hello_document_code_web_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_inherits_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(81306),C_work_hello_document_code_web_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_createSuper_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(12958),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(67294),BaseComponent=function(_Component){(0,C_work_hello_document_code_web_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_inherits_js__WEBPACK_IMPORTED_MODULE_1__.Z)(BaseComponent,_Component);var _super=(0,C_work_hello_document_code_web_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_createSuper_js__WEBPACK_IMPORTED_MODULE_2__.Z)(BaseComponent);function BaseComponent(){return(0,C_work_hello_document_code_web_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_classCallCheck_js__WEBPACK_IMPORTED_MODULE_3__.Z)(this,BaseComponent),_super.apply(this,arguments)}return(0,C_work_hello_document_code_web_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_createClass_js__WEBPACK_IMPORTED_MODULE_4__.Z)(BaseComponent,[{key:"setStateSimple",value:function(key,value,callback){var _this=this,keyArr=key.split("."),state={},stateEval="state";keyArr.map(function(v,i){stateEval="".concat(stateEval,"['").concat(v,"']"),i===0?state[v]=_this.state[v]||{}:eval("".concat(stateEval," = ").concat(stateEval," || {}"))}),stateEval="".concat(stateEval,"=value"),eval(stateEval),(0,C_work_hello_document_code_web_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_get_js__WEBPACK_IMPORTED_MODULE_5__.Z)((0,C_work_hello_document_code_web_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_getPrototypeOf_js__WEBPACK_IMPORTED_MODULE_6__.Z)(BaseComponent.prototype),"setState",this).call(this,state,callback)}}]),BaseComponent}(react__WEBPACK_IMPORTED_MODULE_0__.Component)},88448:function(S,p,e){"use strict";e.r(p),e.d(p,{default:function(){return x}});var w=e(8963),v=e(42020),Z=e(43185),B=e(98670),z=e(74379),A=e(38648),k=e(57663),E=e(71577),G=e(47673),b=e(29730),r=e(11849),H=e(22385),j=e(45777),Y=e(62350),K=e(24565),J=e(48736),I=e(27049),N=e(54029),c=e(79166),Q=e(71153),d=e(60331),V=e(71194),M=e(50146),X=e(34792),h=e(48086),R=e(69610),g=e(54941),T=e(81306),L=e(12958),$=e(67294),C=e(99424),F=e(61806),U=e(68628),W=e(84391),D=e(96190),P=e(17673),O=e(96486),q=e.n(O),_=e(85893),x=function(y){(0,T.Z)(i,y);var f=(0,L.Z)(i);function i(){var u;(0,R.Z)(this,i);for(var s=arguments.length,a=new Array(s),t=0;t<s;t++)a[t]=arguments[t];return u=f.call.apply(f,[this].concat(a)),u.state={param:{page:1,page_rows:10},list:[],total:0,temp_data:{},loading:!1,interval:0},u.bytesToSize=function(o){if(o===0)return"0B";var n=1024,l=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],m=Math.floor(Math.log(o)/Math.log(n));return(o/Math.pow(n,m)).toPrecision(3)+l[m]},u.columns=[{title:"\u540D\u79F0",render:function(n){return(0,_.jsx)("a",{title:"\u70B9\u51FB\u53EF\u9884\u89C8",onClick:function(){if(n.pdf_status!==2){h.default.warning("\u672A\u8F6C\u6362\u6210\u529F,\u65E0\u6CD5\u9884\u89C8");return}M.Z.info({title:n.name,width:"100%",maskClosable:!0,icon:!1,okText:"\u5173\u95ED",content:(0,_.jsx)("iframe",{width:"100%",style:{height:600},src:"/backend/pdf.js/web/viewer.html?file="+n.pdf})})},children:n.name})}},{title:"\u641C\u7D22\u6458\u8981",dataIndex:"highlight_text",width:500,render:function(n){return(0,_.jsx)("div",{dangerouslySetInnerHTML:{__html:n}})}},{title:"\u5927\u5C0F",dataIndex:"size",render:function(n){return u.bytesToSize(n)}},{title:"\u8F6C\u6362\u72B6\u6001",dataIndex:"pdf_status",render:function(n){return[(0,_.jsx)(d.Z,{children:"\u5F85\u8F6C\u6362"}),(0,_.jsx)(d.Z,{color:"#108ee9",children:"\u6B63\u5728\u8F6C\u6362"}),(0,_.jsx)(d.Z,{color:"#87d068",children:"\u8F6C\u6362\u6210\u529F"}),(0,_.jsx)(d.Z,{color:"#f50",children:"\u8F6C\u6362\u5931\u8D25"})][n]}},{title:"zincsearch",dataIndex:"zincsearch_status",render:function(n){return[(0,_.jsx)(c.Z,{status:"default",text:"\u672A\u63A8\u9001"}),(0,_.jsx)(c.Z,{status:"success",text:"\u5DF2\u63A8\u9001"}),(0,_.jsx)(c.Z,{status:"error",text:"\u63A8\u9001\u5931\u8D25"})][n]}},{title:"\u521B\u5EFA\u8005",dataIndex:"creator_name"},{title:"\u521B\u5EFA\u65F6\u95F4",width:160,dataIndex:"create_time"},{title:"\u64CD\u4F5C",render:function(n){return(0,_.jsxs)("div",{children:[(0,_.jsx)("a",{href:"/api/downloadFile?"+P.stringify({ids:n.id,Authorization:(0,D.hP)()}),children:"\u4E0B\u8F7D"}),(0,_.jsx)(I.Z,{type:"vertical"}),(0,_.jsx)(K.Z,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",onConfirm:function(){(0,C.sz)("/api/delFile",{ids:[n.id]}).then(function(m){m.code===200&&(h.default.success("\u5220\u9664\u6210\u529F"),u.fetch())})},children:(0,_.jsx)("a",{style:{color:"red"},children:"\u5220\u9664"})})]})}}],u}return(0,g.Z)(i,[{key:"componentDidMount",value:function(){this.fetch()}},{key:"fetch",value:function(s){var a=this;if(this.setStateSimple("selectedRowKeys",[]),this.state.param.search)this.setStateSimple("columns",this.columns);else{var t=(0,O.cloneDeep)(this.columns);t.splice(1,1),this.setStateSimple("columns",t)}this.setState({loading:s!=null?s:!0},function(){(0,C.sz)("/api/getFileList",a.state.param).then(function(o){if(a.setStateSimple("list",o.info.list),a.setStateSimple("total",o.info.total),a.setStateSimple("loading",!1),o.info.list.findIndex(function(l){return l.pdf_status===0||l.pdf_status===1||l.zincsearch_status===0})===-1)a.state.interval>0&&(clearInterval(a.state.interval),a.setStateSimple("interval",0));else if(a.state.interval===0){var n=a;a.setStateSimple("interval",setInterval(function(){n.fetch(!1)},3e3))}})})}},{key:"render",value:function(){var s=this;return(0,_.jsxs)("div",{children:[(0,_.jsx)("div",{style:{textAlign:"center"},children:(0,_.jsx)(b.Z.Search,{style:{width:"50%"},prefix:(0,_.jsx)(j.Z,{title:"\u9ED8\u8BA4\u4F7F\u7528\u77ED\u8BED\u5339\u914D\u6A21\u5F0F\uFF0C\u76F8\u5F53\u4E8Eelasticsearch\u7684match_phrase\u641C\u7D22\u7C7B\u578B\uFF0C\u5F53\u5173\u952E\u5B57\u5305\u542B*\u6216?\u53F7\u65F6\u4F7F\u7528\u901A\u914D\u7B26\u6A21\u5F0F\u5339\u914D\uFF0C\u76F8\u5F53\u4E8Eelasticsearch\u7684wildcard\u641C\u7D22\u7C7B\u578B\uFF1B\u5F53\u9700\u8981\u591A\u4E2A\u5173\u952E\u5B57\u540C\u65F6\u5339\u914D\u5230\u65F6\uFF0C\u53EF\u4EE5\u901A\u8FC7&\u7B26\u53F7\u5C06\u5173\u952E\u5B57\u8FDE\u63A5\u8D77\u6765\u5B9E\u73B0\u3002",children:(0,_.jsx)(U.Z,{style:{color:"rgba(0,0,0,.45)"}})}),size:"large",allowClear:!0,placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5173\u952E\u5B57",onSearch:function(t){s.setState({param:(0,r.Z)((0,r.Z)({},s.state.param),{},{search:t,page:1})},function(){s.fetch()})}})}),(0,_.jsxs)("div",{style:{background:"white",padding:20,marginTop:20},children:[(0,_.jsx)(E.Z,{disabled:!this.state.selectedRowKeys||this.state.selectedRowKeys.length===0,type:"danger",onClick:function(){M.Z.confirm({title:"\u63D0\u793A",content:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u9879\u76EE\u5417\uFF1F",onOk:function(){(0,C.sz)("/api/delFile",{ids:s.state.selectedRowKeys}).then(function(o){o.code===200&&(h.default.success("\u5220\u9664\u6210\u529F"),s.fetch())})}})},children:"\u5220\u9664\u9009\u4E2D"}),"\xA0 \xA0",(0,_.jsx)(E.Z,{disabled:!this.state.selectedRowKeys||this.state.selectedRowKeys.length===0,type:"dashed",onClick:function(){window.open("/api/downloadFile?"+P.stringify({ids:s.state.selectedRowKeys.join(","),Authorization:(0,D.hP)()}))},children:"\u4E0B\u8F7D\u9009\u4E2D"}),"\xA0 \xA0",(0,_.jsx)(B.Z,{name:"files[]",action:"/api/uploadFile",headers:{authorization:(0,D.hP)()},showUploadList:!1,multiple:!0,onChange:function(t){t.file.status==="uploading"?s.setStateSimple("upload_status",!0):s.setStateSimple("upload_status",!1),t.file.status==="done"&&s.fetch(),t.file.status==="error"&&A.default.error({description:t.file.name+" \u4E0A\u4F20\u5931\u8D25",message:t.file.response.message||"\u672A\u77E5\u9519\u8BEF\uFF0C\u8BF7\u8054\u7CFB\u5F00\u53D1\u4EBA\u5458\u5904\u7406",duration:5})},children:(0,_.jsx)(E.Z,{loading:this.state.upload_status||!1,type:"primary",icon:(0,_.jsx)(W.Z,{}),children:"\u4E0A\u4F20"})})]}),(0,_.jsx)(v.Z,{onChange:function(t){s.setState({param:(0,r.Z)((0,r.Z)({},s.state.param),{},{page:t.current,page_rows:t.pageSize})},function(){s.fetch()})},pagination:{showSizeChanger:!0,current:this.state.param.page,total:this.state.total,pageSize:this.state.param.page_rows,showTotal:function(t){return(0,_.jsxs)("div",{children:["\u603B\u5171 ",t," \u6761\u6570\u636E"]})}},rowSelection:{selectedRowKeys:this.state.selectedRowKeys||[],onChange:function(t){s.setStateSimple("selectedRowKeys",t)}},loading:this.state.loading,rowKey:"id",dataSource:this.state.list,columns:this.state.columns||[]})]})}}]),i}(F.Z)}}]);
